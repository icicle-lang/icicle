:let second_last x = fold (a, b) = (None, None) then (b, Some x) in a

from salary ~> scan v = (second_last value) ~> filter let Some comp = v in group value > comp in count ()

from salary ~> latest 10 ~> scan v = (second_last value) ~> filter let Some comp = v in group value > comp in count ()
